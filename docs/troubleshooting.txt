---
---
Troubleshooting
===============

== Recover from bad flashes with Failsafe mode
Failsafe mode enables you to recover from bad flashes without much trouble. Learn how to access Failsafe mode  http://wiki.villagetelco.org/OpenWrt_Failsafe_Mode_and_Flash_Recovery[here].

Once in failsafe, try to connect. If that does not work, you may need to deactivate DHCP. On Ubuntu:

. Open Network Connections (right click network icon -> edit connections)
. Edit your Ethernet connection
. Under IPv4 settings, set method to manual
. Add a new entry with
.. Address = 192.168.1.1
.. Netmask = 24
.. Gateway = blank
.. Do not change any other fields, save and continue
. The connection should not succeed. From the terminal, execute `telnet 192.168.1.1`

== Unable to establish Ethernet connection
If you can't connect to the LibreMesh router as indicated in link:connecting_nodes.html[How to connect to LiMe nodes] you can try other ways.

=== Verify the connection

If you are connected by cable:

* verify that the cable is well plugged and that the ethernet led on the router or on the computer port show some activity;
* verify that the network manager on your computer is actually trying to connect by this cable;
* if the network manager is down or not installed, connect by the command line activating the ethernet interface and using a DHCP client for asking for an IPv4 to the router. Refer to your operating system documentation for detailed instructions.

If you are connected by wireless:

* check that the wireless physical switch is ON both on the LiMe router and on the computer;
* verify that the network manager on your computer is actually trying to connect to the wireless network named as your network community (with default configuration is +LibreMesh.org+) or on the "named AP" (with default configuration is something like +LibreMesh.org-abc123+), connecting to the +LiMe+ wireless SSID is _not_ likely to work;
* if the network manager is down or not installed, connect by the command line activating the wireless interface, associating to the correct access point, and using a DHCP client for asking for an IPv4 to the router. Refer to your operating system documentation for detailed instructions.

=== Connect using gateway IPv4



=== Connect using IPv6 link local

Each working network interface in your Linux system have a special IPv6 address configured automatically by the Kernel.
These are named IPv6 link-local and are inside the special prefix fe80::/10
The scope of these IPs is to communicate computers which are in the same collision domain, so translated to LiMe it would be the layer2 Cloud.

As an alternative to failsafe, you may create a custom profile to connect over Ethernet.

Create profile:

. Edit connections -> Add -> Select `Ethernet`
. Give it any name you desire, such as `eth0 libre`
. General tab: deselect `Automatic connect`
. IPv4 tab: select `Disabled`
. IPv6 tab: select `Link-Local only`


But, how to know the IPv6 link-local address of the host we want to achieve?
Using ICMPv6 we can discover machines in our network thanks to the special Multicast address "ff02::".
to discover routers (group 2) we can use the next command:

----
ping6 ff02::2%eth0
----

Determine router's IPv6 router direction:

. Turn on your router. Using an Ethernet cable, connect your PC to LAN port. WAN should also work.
. Select the new `eth0 libre` connection from the network manager applet.
. Open a terminal. Execute `ifconfig` to get the name of the Ethernet interface. It is probably something like `eth0` or `enp3s0`. We will assume `eth0` for the rest of this guide.
. Execute `ping6 ff02::1%eth0`.


Then each router connected to our colision domain, will reply the ICMP request with its
 own IPv6 link-local address.

. When the router is ready, each ping should receive a response. The first will be from your own PC and the next (maked as `DUP`) should be your router.
. The router direction is a combination of the router's IPv6 address, `%`, and your Ethernet interface name. It should be something like `fe90::aa20:66ff:fe4f:ae87%eth0`. Do not include a trailing `:` or other text from the ping responses.

Connect with IPv6: Using example router direction above.

. Telnet: `telnet fe90::aa20:66ff:fe4f:ae87%eth0`. If the answer is `Connection refused`, try SSH.
. SSH: `ssh root@fe90::aa20:66ff:fe4f:ae87%eth0`. Remember to include `root@`, otherwise it will attempt to connect using your personal username. The default password is blank. If that doesn't work, try the last password you remember.
. If that does not work, try the IPv4 instructions below. Although that is unlikely to work either.

Or copy files using scp:

----
scp LiMe-fw.bin root@\[fe80::a2f3:c1ff:fe39:1cea%eth1\]:/tmp/
----

link:disc6[Click here] for downloading a small script which check if there is some router attached to your network device and in case, try to connect to it.
If there are not routers it waits until some appears.

An example of execution:

----
p4u@nomada:~$ $ disc6 eth1
...........................Host found, connecting to it!

Warning: Permanently added 'fe80::a2f3:c1ff:fe39:7cea%eth1' (RSA) to the list of known hosts.
root@fe80::a2f3:c1ff:fe39:7cea%eth1's password:
----


Connect with IPv4:

. Execute `dhclient -v eth0` as root, eg `sudo dhclient -v eth0`. This only works using the router's LAN port.
. Open `http://thisnode.info` in your browser.
